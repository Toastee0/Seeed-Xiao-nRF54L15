/*
 * XIAO nRF54L15 Board Configuration Template
 * 
 * This file shows common configuration patterns for XIAO nRF54L15 samples.
 * Copy relevant sections to your sample's boards/xiao_nrf54l15_nrf54l15_cpuapp.overlay
 */

/ {
    /* Common aliases - use as needed for your sample */
    aliases {
        led0 = &led_builtin;        /* Built-in LED (orange) */
        sw0 = &user_button;         /* User button on expansion base */
        vbat-reg = &vbat_pwr;      /* Battery voltage regulator */
    };

    /* Built-in LED configuration */
    leds {
        compatible = "gpio-leds";
        led_builtin: led_builtin {
            gpios = <&xiao_d 10 GPIO_ACTIVE_LOW>;
            label = "Built-in LED";
        };
    };

    /* User button (expansion base) */
    buttons {
        compatible = "gpio-keys";
        user_button: button_0 {
            gpios = <&xiao_d 1 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "User button";
            zephyr,code = <INPUT_KEY_0>;
        };
    };

    /* ADC channels for battery and analog pins */
    zephyr,user {
        io-channels = <&adc 0>, <&adc 1>, <&adc 2>, <&adc 3>,
            <&adc 4>, <&adc 5>, <&adc 6>, <&adc 7>;
    };

    /* GPIO test pins */
    gpio_pins {
        compatible = "gpio-leds";
        
        test_pin_0: test_pin_0 {
            gpios = <&xiao_d 0 GPIO_ACTIVE_HIGH>;
            label = "Test pin D0";
        };
        
        test_pin_2: test_pin_2 {
            gpios = <&xiao_d 2 GPIO_ACTIVE_HIGH>;
            label = "Test pin D2";
        };
        
        test_pin_3: test_pin_3 {
            gpios = <&xiao_d 3 GPIO_ACTIVE_HIGH>;
            label = "Test pin D3";
        };
    };
};

/* I2C configuration for sensors and displays */
&xiao_i2c {
    clock-frequency = <400000>;
    status = "okay";
    
    /* LSM6DSO IMU (on XIAO nRF54L15 Sense) */
    lsm6dso@6a {
        compatible = "st,lsm6dso";
        reg = <0x6a>;
        irq-gpios = <&xiao_d 8 GPIO_ACTIVE_HIGH>;
        label = "LSM6DSO";
    };
    
    /* SSD1306 OLED Display (expansion base) */
    ssd1306@3c {
        compatible = "solomon,ssd1306fb";
        reg = <0x3c>;
        width = <128>;
        height = <64>;
        segment-offset = <0>;
        page-offset = <0>;
        display-offset = <0>;
        multiplex-ratio = <63>;
        prechargep = <0x22>;
    };
};

/* SPI configuration for SD card, external sensors */
&xiao_spi {
    status = "okay";
    cs-gpios = <&xiao_d 7 GPIO_ACTIVE_LOW>;
    
    /* SD Card slot (expansion base) */
    sdhc0: sdhc@0 {
        compatible = "zephyr,sdhc-spi-slot";
        reg = <0>;
        status = "okay";
        spi-max-frequency = <24000000>;
        mmc {
            compatible = "zephyr,sdmmc-disk";
            status = "okay";
        };
    };
};

/* UART configuration for GPS, debug, etc. */
&xiao_serial {
    status = "okay";
    current-speed = <9600>;
};

/* PWM configuration for LEDs, servos, etc. */
&pwm20 {
    status = "okay";
    pinctrl-0 = <&pwm20_default>;
    pinctrl-names = "default";
};

/* Pin control for PWM */
&pinctrl {
    pwm20_default: pwm20_default {
        group1 {
            psels = <NRF_PSEL(PWM_OUT0, 1, 12)>;  /* D0 pin */
        };
    };
};